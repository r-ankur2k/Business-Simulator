<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Economy Sim: Education, Jobs, Exams, Prereqs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { --primary:#2255aa; --accent:#ffaa22; --bg:#f6f8fa; --surface:#fff; --border:#dde4ef; --danger:#e35c47; --win:#42be6b; --pad:30px; --fs:1.14em;}
    body { margin:0; padding:0; font-family:'Segoe UI',Roboto,sans-serif; background:var(--bg); color:#133552; }
    .app-container { max-width:1080px; margin:58px auto; background:var(--surface); border-radius:1.5em; box-shadow:0 4px 28px #bbd1f444; padding:var(--pad) 40px; min-height:780px;}
    h1 { text-align:center; color:var(--primary); font-size:2.3em; letter-spacing:.04em; margin-bottom:2.2em;}
    .tab-bar { display:flex; flex-direction:column; gap:0.7em; margin-bottom:32px;}
    .tab-bar button { width:100%; padding:18px 0; font-size:1.19em; border:none; background:var(--bg); color:var(--primary); cursor:pointer; border-radius:13px; transition:background .22s, color .22s;}
    .tab-bar button.active { background:var(--primary); color:#fff; font-weight:bold; border-bottom:2px solid var(--accent);}
    .section { display:none;}
    .section.active { display:block;}
    .statbox { display:grid; grid-template-columns:repeat(auto-fit,minmax(235px,1fr)); gap:1.6em; margin-bottom:35px;}
    .stat { background:var(--bg); border-radius:1.1em; padding:25px 22px; font-size:1.18em; line-height:1.68; font-weight:500; box-shadow:0 1px 2px #c5d8ed26; border:1.5px solid var(--border);}
    table { width:100%; border-collapse:collapse; background:var(--surface); margin-bottom:14px;}
    th,td { border:1.4px solid var(--border); padding:13px 10px; text-align:left; font-size:1.13em;}
    th { background:#e7eefb; color:var(--primary);}
    td button { padding:7px 19px; border-radius:5px; border:none; cursor:pointer; background:var(--primary); color:#fff; font-size:1.09em; transition:background .18s;}
    td button:disabled { background:#999; cursor:not-allowed;}
    .property-card { background:var(--bg); border-radius:0.8em; padding:15px 25px; margin-bottom:11px; border-left:5px solid var(--primary); color:#224; font-size:1.1em;}
    .business-card { background:#fffbe5; border-radius:0.7em; border-left:6px solid var(--accent); padding:14px 15px 13px 30px; margin-bottom:8px; color:#763c11; font-size:1.09em;}
    .event { font-size:1.08em; padding:16px 18px; margin:9px 0 0 0; background:#eef4fd; border-left:5px solid var(--primary); border-radius:0.5em;}
    .event.danger { background:#fff1ee; color:var(--danger); border-left:6px solid var(--danger);}
    .event.win { background:#eaffef; color:var(--win); border-left:6px solid var(--win);}
    .analytics-table th,.analytics-table td { font-size:1.06em;}
    .controls { margin:19px 0 29px 0; display:flex; gap:24px; flex-wrap:wrap;}
    .controls button { padding:11px 33px; background:var(--primary); color:#fff; border:none; font-size:1.18em; border-radius:0.7em; cursor:pointer; font-weight:500; transition:background .13s;}
    .controls button:active { background:#194278;}
    .note { font-size:1.07em; margin:13px 0 0 0; color:#444;}
    .risk { color:var(--danger); font-weight:500;}
    .final-msg { margin:25px auto; padding:2.1em; font-size:1.32em; color:#045; background:#eaffef; border-left:11px solid #42be6b; border-radius:1em; text-align:center;}
    .course-card { background:#fefad8; border-left:6px solid #ffaa22; border-radius:10px; margin-bottom:1.2em; padding:13px 24px;}
    .disabledish { opacity:0.7; pointer-events:none;}
    @media (max-width:700px) {.app-container {padding:16px 6vw;} table th,table td {padding:7px 3px; font-size:.97em;} .stat{font-size:1em;}}
  </style>
</head>
<body>
<div class="app-container">
  <h1>Economy Simulator (Education, Jobs, Exams, Prereqs)</h1>
  <div class="tab-bar">
    <button onclick="setTab(0)">Dashboard</button>
    <button onclick="setTab(1)">Education & Job</button>
    <button onclick="setTab(2)">Marketplace</button>
    <button onclick="setTab(3)">Properties</button>
    <button onclick="setTab(4)">Invest/Bank</button>
    <button onclick="setTab(5)">Events</button>
    <button onclick="setTab(6)">Analytics</button>
  </div>
  <div id="sections">
    <div class="section" id="dashboard"></div>
    <div class="section" id="jobs"></div>
    <div class="section" id="market"></div>
    <div class="section" id="property"></div>
    <div class="section" id="bank"></div>
    <div class="section" id="events"></div>
    <div class="section" id="analytics"></div>
  </div>
</div>
<script>
const START_AGE=20,END_AGE=80,MONTHS_PER_TURN=6;
const TURNS=(END_AGE-START_AGE)*12/MONTHS_PER_TURN; // 120
let finished=false;
let player={
  name:"Player",cash:2000,salary:0,job:null,jobLevel:-1,
  businesses:[],properties:[],rentIncome:0,stocks:[],
  loan:0,studentLoan:0,studies:null,jobTarget:null,
  interviewCooldown:0,failedAttempts:{},turn:1,
  eventLog:[],analytics:[], // SPECIAL
  completedCourses:{},
};
let JOB_ODD={name:"Odd Jobs (No Degree)",salary:250*6,course:null,id:0};
let jobs=[
  JOB_ODD,
  {name:"Office Clerk",salary:440*6,course:"Certificate",id:1},
  {name:"Sales Rep",salary:600*6,course:"Diploma",id:2},
  {name:"Engineer",salary:900*6,course:"Bachelor's",id:3},
  {name:"Consultant",salary:1300*6,course:"Master's",id:4},
  {name:"Manager",salary:1750*6,course:"MBA",id:5},
  {name:"Director",salary:2200*6,course:"Executive MBA",id:6}
];
let courses=[
  {name:"Certificate",cost:1200,duration:2,prereq:null},
  {name:"Diploma",cost:3300,duration:3,prereq:"Certificate"},
  {name:"Bachelor's",cost:6800,duration:5,prereq:"Diploma"},
  {name:"Master's",cost:8200,duration:4,prereq:"Bachelor's"},
  {name:"MBA",cost:10000,duration:4,prereq:"Bachelor's"},
  {name:"Executive MBA",cost:13500,duration:5,prereq:"MBA"}
];
let businesses=[
  {name:"Food Cart",cost:1700,profit:190*6,bustChance:.08},
  {name:"Bookshop",cost:3700,profit:335*6,bustChance:.085},
  {name:"Delivery Startup",cost:7000,profit:730*6,bustChance:.093},
  {name:"App Platform",cost:13000,profit:1520*6,bustChance:.1}
];
let properties=[
  {name:"Micro Apartment",price:2600,rent:90*6},
  {name:"Premium Flat",price:11000,rent:380*6},
  {name:"Downtown Office",price:23200,rent:870*6}
];
let stockFund={unit:1000};
function stocksValue(){return player.stocks.reduce((a,s)=>a+s.value,0);}
let eventsList=[
  ()=>{let v=100+Math.floor(Math.random()*90);player.cash+=v;logEvent(`Windfall! Found $${v}.`,'win');},
  ()=>{let v=140+Math.floor(Math.random()*100);player.cash-=v;logEvent("Unexpected expenses: Lost $"+v,'danger');},
  ()=>{let d=110+Math.floor(Math.random()*110);if(player.salary){player.salary+=d;logEvent(`Promotion! Salary gain $${d}/6mo.`,'win');}},
  ()=>{let d=-Math.floor(player.salary*.13);if(player.salary){player.salary+=d;logEvent(`Pay-cut: Salary drops $${-d}/6mo.`,'danger');}},
  ()=>{let l=450+Math.floor(Math.random()*220);player.loan+=l;player.cash+=l;logEvent("Emergency loan ($"+l+")",'danger');},
  ()=>{if(player.stocks.length>0){let i=Math.floor(Math.random()*player.stocks.length);let s=player.stocks[i];let loss=Math.floor(s.value*.13);s.value=Math.max(0,s.value-loss);logEvent(`Stock/ETF crash! Lost $${loss}.`,'danger');}},
  ()=>{if(player.businesses.length){let idx=Math.floor(Math.random()*player.businesses.length);let b=player.businesses[idx];player.businesses.splice(idx,1);logEvent(`Business bankruptcy! ${b.name} failed.`,'danger');}},
  ()=>{if(player.properties.length){let p=player.properties[Math.floor(Math.random()*player.properties.length)];p.rent=Math.max(0,p.rent-62);logEvent("Rental market dip‚Äîproperty rent fell!",'danger');}},
  ()=>{player.cash+=120;logEvent("Gov subsidy: $120",'win');}
];
// --- Core functions ---
function logEvent(msg,level=""){player.eventLog.unshift({txt:msg,turn:player.turn,level});}
function currAgeObj(){let months=(player.turn-1)*MONTHS_PER_TURN;let years=START_AGE+Math.floor(months/12);let mos=months%12;return{years,mos};}
function currAgeString(){let{years,mos}=currAgeObj();return `${years} yrs ${mos} mo`;}
function nextTurn(){
  if(finished)return;
  // Education
  if(player.studies){
    player.studies.turnsLeft--;
    logEvent(`Studying: ${player.studies.name} (${player.studies.turnsLeft} turns left)`);
    player.salary=0; // no regular job during study!
    if(player.studies.turnsLeft<=0){
      // EXAM: 10% fail chance!
      if(Math.random()<0.1){
        logEvent(`Failed final exam for ${player.studies.name}! Must repeat course.`,"danger");
        let c=courses.find(c=>c.name===player.studies.name);
        let cost=c.cost; // repay tuition
        if(player.cash>=cost){player.cash-=cost;}
        else{let borrow=cost-player.cash;player.studentLoan+=borrow;player.cash=0;}
        player.studies={...c,completed:false,turnsLeft:c.duration};
      }else{
        player.studies.completed=true;
        player.completedCourses[player.studies.name]=true;
        logEvent(`Finished course: ${player.studies.name}! Unlocked new job(s).`,"win");
        player.studies=null;
      }
    }
  }
  // Student loan interest: 1.6% per turn (6 mo)
  if(player.studentLoan>0){let si=Math.round(player.studentLoan*.016);player.studentLoan+=si;logEvent(`Student loan interest: +$${si}`);}
  // If no job and not studying: odd jobs
  if(!player.studies&&(!player.job||player.jobLevel==0)){player.job=JOB_ODD.name;player.salary=JOB_ODD.salary;player.jobLevel=0;}
  // Income
  player.cash+=player.salary;logEvent(`Salary credited: $${player.salary}/6mo`);
  let bprofit=0;
  if(player.businesses.length>0){
    let bizList=[...player.businesses];
    bizList.forEach((biz,i)=>{
      if(Math.random()<biz.bustChance){logEvent(`Business bankruptcy! ${biz.name} failed.`,'danger');
        let idx=player.businesses.findIndex(b=>b.name===biz.name);if(idx>-1)player.businesses.splice(idx,1);}
      else{let fluct=Math.random()<.18?-Math.floor(biz.profit*Math.random()*.8):Math.floor(Math.random()*.2*biz.profit);
        let realProfit=biz.profit+fluct;bprofit+=realProfit;logEvent(`${biz.name} profit: ${(realProfit>=0?"+":"")}$${realProfit} (6mo)`);}
    });if(bprofit)player.cash+=bprofit;
  }
  let rent=0;player.properties.forEach(p=>{rent+=p.rent;});
  if(rent){player.cash+=rent;logEvent(`Rental income: +$${rent}/6mo`);}
  if(player.stocks.length>0){
    let changeSum=0;
    player.stocks.forEach(s=>{let swing=Math.floor(s.value*((Math.random()*.20)-.09));
      s.value+=swing;s.value=Math.max(0,s.value);changeSum+=swing;});
    if(changeSum!==0)logEvent(`Investments value change: ${(changeSum>=0?"+":"")}$${changeSum}`,changeSum<0?'danger':'win');
  }
  let intst=Math.floor(Math.max(0,player.cash*.0027));
  if(intst>0){player.cash+=intst;logEvent(`Interest: +$${intst}`);}
  if((player.turn%3)===0){player.cash+=160;logEvent("Gov bonus: +$160",'win');}
  if(player.loan>0){let pay=Math.min(120,player.loan,player.cash);player.cash-=pay;player.loan-=pay;logEvent(`Paid $${pay} loan (left: $${player.loan})`);}
  let expense=Math.floor(470+Math.random()*170);player.cash-=expense;logEvent(`Living expenses: -$${expense}/6mo`);
  if(Math.random()<0.44){eventsList[Math.floor(Math.random()*eventsList.length)]();}
  player.analytics.push({
    turn:player.turn,age:currAgeString(),cash:player.cash,salary:player.salary,
    job:player.job,business:player.businesses.length?player.businesses.map(b=>b.name).join(', '):'',
    bprofit:bprofit,rent:rent,loan:player.loan,studentLoan:player.studentLoan,stocks:stocksValue()
  });
  if(player.cash<0&&stocksValue()<=0&&(player.loan+player.studentLoan)>0) logEvent("You're broke and in debt! Seek jobs or study quickly!","danger");
  if(player.turn>=TURNS){
    finished=true;
    logEvent(`GAME COMPLETE at Age 80!`,"win");
    logEvent(`Final: Cash $${Math.round(player.cash)}, Stocks $${Math.round(stocksValue())}, Businesses: ${player.businesses.map(b=>b.name).join(', ')||'none'}`,"win");
  }else{player.turn++;}
  render();
}

// COURSE ENROLL/PREREQ
function canTakeCourse(idx){
  let c=courses[idx];
  if(c.prereq){
    return !!player.completedCourses[c.prereq];
  }
  return true;
}
function startCourse(cidx){
  let c=courses[cidx];
  if(finished||player.studies)return;
  if(!canTakeCourse(cidx)){
    logEvent(`You must first finish ${c.prereq} before starting this course.`,"danger");return;
  }
  if(player.cash>=c.cost){player.cash-=c.cost;}
  else{let borrowed=c.cost-player.cash;player.studentLoan+=borrowed;player.cash=0;}
  player.studies={...c,completed:false,turnsLeft:c.duration};
  logEvent(`Started course: ${c.name}`,"win");
  render();
}

// INTERVIEW
function eligibleJobForCourse(course){return jobs.filter(j=>j.course===course).map(j=>j.name).join(", ");}
function hasCourse(course){return !!player.completedCourses[course];}
function tryJob(pjid){
  if(finished||player.studies)return;
  let idx=jobs.findIndex(j=>j.id===pjid);let job=jobs[idx];
  if(!job)return;
  if(job.course&&!hasCourse(job.course)){
    logEvent(`You need ${job.course} to apply for this job`,"danger");return;
  }
  if(Math.random()<0.2){
    logEvent(`Interview failed for ${job.name}. Try again next turn.`,"danger");
    player.failedAttempts[job.name]=(player.failedAttempts[job.name]||0)+1;
    player.interviewCooldown=1;render();return;
  }
  player.job=job.name;player.salary=job.salary;player.jobLevel=idx;
  player.jobTarget=null;player.failedAttempts[job.name]=0;
  logEvent(`Congratulations! You got the ${job.name} job at $${job.salary}/6mo`,"win");
  render();
}

// ECONOMY
function buyBusiness(idx){
  if(finished)return;
  let biz=businesses[idx];
  if(player.cash>=biz.cost&&!player.businesses.find(b=>b.name===biz.name)){
    player.cash-=biz.cost;player.businesses.push({...biz});
    logEvent(`Started business: ${biz.name} ($${biz.profit}/6mo)`);render();
  }
}
function buyProperty(idx){
  if(finished)return;
  let prop=properties[idx];
  if(player.cash>=prop.price&&!player.properties.find(p=>p.name===prop.name)){
    player.cash-=prop.price;player.properties.push({...prop});
    logEvent(`Bought property: ${prop.name}`);render();
  }
}
function investStock(){
  if(finished)return;
  if(player.cash>=stockFund.unit){player.cash-=stockFund.unit;player.stocks.push({name:"ETF",value:stockFund.unit});
    logEvent(`Invested $${stockFund.unit} in Stock/ETF.`);render();}
}
function cashoutStocks(){
  if(finished)return;
  let value=stocksValue();
  if(value>0){player.cash+=value;player.stocks=[];logEvent(`Cashed out all stocks for $${value}.`,'win');render();}
}
function takeLoan(){
  if(finished)return;
  if(player.loan<12000){player.cash+=1750;player.loan+=1750;logEvent("Loan taken: $1750",'danger');render();}
}
function repayLoan(){
  if(finished)return;
  let amt=Math.min(player.loan,player.cash);
  if(player.loan>0&&amt>0){player.cash-=amt;player.loan-=amt;logEvent(`Loan repaid: $${amt}.`);render();}
}
function repayStudentLoan(){
  if(finished)return;
  let amt=Math.min(player.studentLoan,player.cash);
  if(player.studentLoan>0&&amt>0){player.cash-=amt;player.studentLoan-=amt;logEvent(`Student loan repaid: $${amt}.`);render();}
}

// UI
function setTab(idx){
  let tabs=document.querySelectorAll(".tab-bar button");
  let secs=document.querySelectorAll(".section");
  tabs.forEach((t,i)=>t.classList.toggle("active",i===idx));
  secs.forEach((d,i)=>d.classList.toggle("active",i===idx));
  render();
}

function render(){
  let{years,mos}=currAgeObj();
  document.getElementById("dashboard").innerHTML=`
    <div class="statbox">
      <div class="stat"><b>Turn:</b> ${player.turn} <span style="color:#555;font-size:1.04em;">(Age ${years} yrs ${mos} mo)</span></div>
      <div class="stat"><b>Cash:</b> $${Math.round(player.cash)}</div>
      <div class="stat"><b>Job:</b> ${player.job?player.job:"None"} <br/>( $${player.salary||0}/6mo )</div>
      <div class="stat"><b>Student Loan:</b> $${Math.round(player.studentLoan)}</div>
      <div class="stat"><b>Rental Income:</b> $${player.properties.reduce((a,b)=>a+b.rent,0)||0}/6mo</div>
      <div class="stat"><b>Business(es):</b> ${player.businesses.length?player.businesses.map(b=>b.name).join(', '):'<i>None</i>'}</div>
      <div class="stat"><b>Investment Value:</b> $${stocksValue()}<br/><span style="font-size:1.04em;">(${player.stocks.length} holding)</span></div>
      <div class="stat"><b>Loan:</b> $${Math.round(player.loan)}</div>
    </div>
    <div class="controls">
      <button onclick="nextTurn()" ${finished?"disabled":""}>‚è≠ Next Turn (6 mo)</button>
      <button onclick="takeLoan()" ${finished?"disabled":""}>Take $1750 Loan</button>
      <button onclick="repayLoan()" ${player.loan==0||finished?"disabled":""}>Repay Loan</button>
      <button onclick="repayStudentLoan()" ${player.studentLoan==0||finished?"disabled":""}>Repay Student Loan</button>
    </div>
    <div>
      <b>Recent Events</b>
      ${player.eventLog.slice(0,4).map(e=>`<div class="event${e.level?' '+e.level:''}"><b>T${e.turn}:</b> ${e.txt}</div>`).join("")}
    </div>
    ${finished ? `<div class='final-msg'>Game Complete: Age 80!<br>
      <b>Final Wealth:</b> $${Math.round(player.cash)} cash, $${stocksValue()} investments, ${player.businesses.length?player.businesses.map(b=>b.name).join(', '):'no business'}, ${player.properties.length?player.properties.map(p=>p.name).join(', '):'no property'}.
    </div>` : `<div class='note risk'><span>Some degrees require prerequisites. There‚Äôs a 10% fail chance on all exams. Education unlocks wealth and jobs! UI designed for wide screens and accessibility.</span></div>` }
  `;
  // Jobs/Education
  document.getElementById("jobs").innerHTML=`
    ${player.studies?`
      <div class="course-card">
        <b>In course:</b> ${player.studies.name} (${player.studies.turnsLeft} turns left)
        <div class="note">10% chance of failing exam at end; if failed, must re-enroll & pay again.</div>
      </div>
      <div class="note">No job income except "odd jobs" while studying.</div>
    `:`
      <div>
        <b>Start a Course:</b>
        ${courses.map((c,i)=>
          `<div class="course-card${!canTakeCourse(i)?' disabledish':''}">
            <b>${c.name}</b> ‚Äî $${c.cost} / Duration: ${c.duration} turns
            ${c.prereq?`<span style="color:#444;font-size:1.01em;"> (Requires: ${c.prereq})</span>`:""}
            <button onclick="startCourse(${i})" ${(player.studies||finished||!canTakeCourse(i))?"disabled":""}>Enroll</button></div>`
        ).join("")}
      </div>
    `}
    <b>Job Application</b>
    ${jobs.map(j=>
      `<div style="margin-bottom:.6em;">
        <span><b>${j.name}</b> ‚Äî $${j.salary}/6mo ${j.course?`(needs ${j.course})`:''}</span>
        <button onclick="tryJob(${j.id})" ${finished||player.studies||(j.course&&!hasCourse(j.course))?"disabled":""}>Apply</button>
        ${player.failedAttempts[j.name]?'<span class="risk" style="margin-left:1em;">failed last attempt</span>':''}
      </div>`
    ).join("")}
    <div class='note'>Interview: 20% fail rate. Education, exams, and course prereqs required for most jobs.</div>
  `;
  // Market
  document.getElementById("market").innerHTML=`
    <b>Stock & ETF Fund</b>
    <table>
      <tr><th>Name</th><th>Unit Price</th><th>Buy</th></tr>
      <tr>
        <td>ETF Fund</td>
        <td>$${stockFund.unit}</td>
        <td><button onclick="investStock()" ${player.cash<stockFund.unit||finished?"disabled":""}>Invest</button></td>
      </tr>
    </table>
    <div style="margin:.7em 0">
      <button onclick="cashoutStocks()" ${player.stocks.length==0||finished?"disabled":""}>üíµ Cash Out All Investments</button>
      <span class='note'>(Get value for all stock/ETF. Value fluctuates every 6mo!)</span>
    </div>
    <div class="note risk">Stocks can lose value/crash, especially in market downturns. Each turn=6mo.</div>
  `;
  // Properties
  let owned=player.properties;
  let avail=properties.filter(p=>!owned.find(q=>q.name===p.name));
  document.getElementById("property").innerHTML=`
    <b>Owned Properties</b>
    ${owned.length?owned.map(p=>`
      <div class="property-card">
        <b>${p.name}</b> ‚Äî Value: $${p.price}, Rent: $${p.rent}/6mo
      </div>
      `).join(""):'<div class="property-card"><i>None</i></div>'}
      <b>Available</b>
      ${avail.length?avail.map((p,idx)=>`
        <div class="property-card">
          <b>${p.name}</b> ‚Äî Price: $${p.price}, Rent: $${p.rent}/6mo
          <button onclick="buyProperty(${idx})" ${player.cash<p.price||finished?"disabled":""}>Buy</button>
        </div>
      `).join(""):'<div class="property-card">No more properties for sale</div>'}
    <span class="note">Rent applies every 6mo. Market events decrease rents sometimes.</span>
  `;
  // Bank/Invest
  document.getElementById("bank").innerHTML=`
    <div class="statbox">
      <div class="stat"><b>Cash:</b> $${Math.round(player.cash)}</div>
      <div class="stat"><b>Investments</b>: $${stocksValue()}<br/>(${player.stocks.length} ETF/holdings)</div>
      <div class="stat"><b>Loan</b>: $${Math.round(player.loan)}</div>
      <div class="stat"><b>Student Loan</b>: $${Math.round(player.studentLoan)}</div>
    </div>
    <div class="controls">
      <button onclick="investStock()" ${player.cash<stockFund.unit||finished?"disabled":""}>Invest $1000 in Stock/ETF</button>
      <button onclick="cashoutStocks()" ${player.stocks.length==0||finished?"disabled":""}>Cash Out All Stocks</button>
      <button onclick="repayLoan()" ${player.loan==0||finished?"disabled":""}>Repay Loan</button>
      <button onclick="repayStudentLoan()" ${player.studentLoan==0||finished?"disabled":""}>Repay Student Loan</button>
    </div>
    <span class="note risk">Student loan accrues interest each turn! Pay down both debts quickly.</span>
  `;
  // Events
  document.getElementById("events").innerHTML=`<b>Event Log (latest first)</b><br>`+player.eventLog.slice(0,18).map(e=>(
    `<div class="event${e.level?' '+e.level:''}"><b>T${e.turn}:</b> ${e.txt}</div>`
  )).join("");
  // Analytics
  let hist=player.analytics.slice(-18);
  document.getElementById("analytics").innerHTML=`
    <b>Progress by Turn (120 = Age 80)</b>
    <div style="overflow:auto;">
    <table class="analytics-table">
      <tr>
        <th>Turn</th><th>Age</th><th>Cash</th><th>Salary</th>
        <th>Job</th><th>Business</th><th>B.Profit</th><th>Rental</th><th>Loan</th><th>Stud.Loan</th><th>Investments</th>
      </tr>
      ${hist.map(r=>
        `<tr>
          <td>${r.turn}</td>
          <td>${r.age}</td>
          <td>$${Math.round(r.cash)}</td>
          <td>$${r.salary||0}</td>
          <td>${r.job||''}</td>
          <td>${r.business}</td>
          <td>$${r.bprofit}</td>
          <td>$${r.rent}</td>
          <td>$${r.loan}</td>
          <td>$${Math.round(r.studentLoan||0)}</td>
          <td>$${r.stocks}</td>
        </tr>`
      ).join("")}
    </table></div>
    <div class="note">Degrees require prereqs (ex: Grad before MBA). 10% chance of failing exams! Study, apply, invest‚Äîtry not to go bankrupt!</div>
  `;
}
setTab(0);
render();
</script>
</body>
</html>
